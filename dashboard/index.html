<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram</title>
</head>
<body>
    <script async src="https://telegram.org/js/telegram-widget.js?22"
        data-telegram-login="rptx_bot"
        data-size="large"
        data-userpic="false"
        data-request-access="write"
        data-on-auth="onTelegramAuth">
    </script>
    <script>
        Object.defineProperty(window, 'onTelegramAuth', {
            value: function(user) {
                console.log("‚úÖ onTelegramAuth –≤—ã–∑–≤–∞–Ω–∞!");
                console.log("User:", user);
                localStorage.setItem("telegram_user", JSON.stringify(user));
                window.location.href = `/dashboard/main.html?user_id=${user.id}`;
            },
            writable: true
        });

        document.addEventListener("DOMContentLoaded", () => {
            console.log("üì¶ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞");
            const savedUser = localStorage.getItem("telegram_user");
            if (savedUser) {
                const user = JSON.parse(savedUser);
                console.log("üîÅ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω:", user);
                window.location.href = `/dashboard/main.html?user_id=${user.id}`;
            }
        });
    </script>
</body>
</html>