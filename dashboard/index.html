<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Авторизация через Telegram</title>
    <script>
        function onTelegramAuth(user) {
            console.log("Получены данные от Telegram:", user);
            localStorage.setItem("telegram_user", JSON.stringify(user));
            window.location.href = `/dashboard/main.html?user_id=${user.id}`;
        }

        document.addEventListener("DOMContentLoaded", () => {
            console.log("Страница загружена");

            const savedUser = localStorage.getItem("telegram_user");
            if (savedUser) {
                const user = JSON.parse(savedUser);
                console.log("Пользователь уже авторизован:", user);
                window.location.href = `/dashboard/main.html?user_id=${user.id}`;
            }
        });
    </script>
</head>
<body>
    <script async src="https://telegram.org/js/telegram-widget.js?22"
        data-telegram-login="rptx_bot"
        data-size="large"
        data-userpic="false"
        data-request-access="write"
        data-on-auth="onTelegramAuth">
    </script>
</body>
</html>