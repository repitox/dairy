<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        button.success {
            background: #28a745;
        }
        button.warning {
            background: #ffc107;
            color: #212529;
        }
        button.danger {
            background: #dc3545;
        }
        .result {
            margin: 20px 0;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        pre {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h1>
        <p>–≠—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø–æ–º–æ–∂–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–æ–µ–∫—Ç–æ–≤.</p>
        
        <div class="actions">
            <button onclick="setTestUser()" class="success">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
            <button onclick="checkUser()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
            <button onclick="clearUser()" class="danger">–û—á–∏—Å—Ç–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
            <button onclick="testProjects()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ–µ–∫—Ç—ã</button>
        </div>
        
        <div id="result"></div>
        
        <h2>üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏</h2>
        <ol>
            <li>–ù–∞–∂–º–∏—Ç–µ "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"</li>
            <li>–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ <a href="/dashboard/projects.html" target="_blank">—Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä–æ–µ–∫—Ç–æ–≤</a></li>
            <li>–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ (F12) –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤</li>
            <li>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—Ä–æ–µ–∫—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ</li>
        </ol>
        
        <h2>üêõ –û—Ç–ª–∞–¥–∫–∞</h2>
        <p>–ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç—ã –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:</p>
        <pre>
// –ü—Ä–æ–≤–µ—Ä–∫–∞ localStorage
console.log('localStorage —Å–æ–¥–µ—Ä–∂–∏—Ç:', localStorage.getItem('telegram_user'));

// –ü—Ä–æ–≤–µ—Ä–∫–∞ Auth
console.log('Auth.getCurrentUser():', Auth.getCurrentUser());

// –†—É—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤
fetch('/api/user-projects?user_id=123456789')
    .then(response => response.json())
    .then(data => console.log('–ü—Ä–æ–µ–∫—Ç—ã:', data))
    .catch(error => console.error('–û—à–∏–±–∫–∞:', error));
        </pre>
    </div>
    
    <script>
        const testUser = {
            "id": 123456789,
            "user_id": 123456789,
            "first_name": "–¢–µ—Å—Ç–æ–≤—ã–π",
            "last_name": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
            "username": "testuser"
        };
        
        function setTestUser() {
            try {
                localStorage.setItem('telegram_user', JSON.stringify(testUser));
                showResult('–¢–µ—Å—Ç–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!', 'success');
                console.log('–¢–µ—Å—Ç–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:', testUser);
            } catch (error) {
                showResult('–û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ' + error.message, 'error');
                console.error('–û—à–∏–±–∫–∞:', error);
            }
        }
        
        function checkUser() {
            try {
                const user = localStorage.getItem('telegram_user');
                if (user) {
                    const userData = JSON.parse(user);
                    showResult('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–π–¥–µ–Ω: ' + JSON.stringify(userData, null, 2), 'info');
                    console.log('–¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:', userData);
                } else {
                    showResult('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ localStorage', 'error');
                }
            } catch (error) {
                showResult('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ' + error.message, 'error');
                console.error('–û—à–∏–±–∫–∞:', error);
            }
        }
        
        function clearUser() {
            try {
                localStorage.removeItem('telegram_user');
                showResult('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—á–∏—â–µ–Ω –∏–∑ localStorage', 'info');
                console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—á–∏—â–µ–Ω');
            } catch (error) {
                showResult('–û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ' + error.message, 'error');
                console.error('–û—à–∏–±–∫–∞:', error);
            }
        }
        
        async function testProjects() {
            try {
                const response = await fetch('/api/user-projects?user_id=123456789');
                if (response.ok) {
                    const projects = await response.json();
                    showResult('–ù–∞–π–¥–µ–Ω–æ –ø—Ä–æ–µ–∫—Ç–æ–≤: ' + projects.length + '\\n' + JSON.stringify(projects, null, 2), 'success');
                    console.log('–ü—Ä–æ–µ–∫—Ç—ã:', projects);
                } else {
                    showResult('–û—à–∏–±–∫–∞ API: ' + response.status + ' ' + response.statusText, 'error');
                }
            } catch (error) {
                showResult('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤: ' + error.message, 'error');
                console.error('–û—à–∏–±–∫–∞:', error);
            }
        }
        
        function showResult(message, type) {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `<div class="result ${type}"><pre>${message}</pre></div>`;
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', function() {
            checkUser();
        });
    </script>
</body>
</html>