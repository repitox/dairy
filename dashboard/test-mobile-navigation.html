<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –º–æ–±–∏–ª—å–Ω–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ - Dashboard</title>
    <link rel="preload" href="/api/navigation?category=main" as="fetch" crossorigin>
    <link rel="stylesheet" href="ui-components.css">
    <link rel="stylesheet" href="navigation-api.css">
    <style>
        .test-content {
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .test-section {
            background: var(--glass-light);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-large);
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .test-info {
            background: var(--accent-gradient);
            color: white;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
        }
        
        .device-info {
            font-family: monospace;
            background: rgba(0, 0, 0, 0.1);
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
        }
        
        .navigation-status {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        
        .status-badge {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .status-success {
            background: #10b981;
            color: white;
        }
        
        .status-error {
            background: #ef4444;
            color: white;
        }
        
        .status-warning {
            background: #f59e0b;
            color: white;
        }
    </style>
</head>
<body>
    <!-- API –Ω–∞–≤–∏–≥–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ -->
    <script src="auth.js"></script>
    <script src="navigation-api-loader.js"></script>
    
    <div class="test-content">
        <div class="test-info">
            <h1>üß™ –¢–µ—Å—Ç –º–æ–±–∏–ª—å–Ω–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏</h1>
            <p>–≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –º–µ–Ω—é dashboard.</p>
            <div class="device-info" id="device-info">
                –ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ...
            </div>
        </div>
        
        <div class="test-section">
            <h2>üì± –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é</h2>
            <ol>
                <li><strong>–î–µ—Å–∫—Ç–æ–ø:</strong> –£–º–µ–Ω—å—à–∏—Ç–µ —à–∏—Ä–∏–Ω—É –æ–∫–Ω–∞ –±—Ä–∞—É–∑–µ—Ä–∞ –¥–æ 768px –∏–ª–∏ –º–µ–Ω—å—à–µ</li>
                <li><strong>–ú–æ–±–∏–ª—å–Ω—ã–π:</strong> –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ</li>
                <li><strong>–ú–µ–Ω—é:</strong> –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É ‚ò∞ –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É</li>
                <li><strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:</strong> –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ª–∏ –≤—Å–µ –ø—É–Ω–∫—Ç—ã –º–µ–Ω—é –∏–∑ –ë–î</li>
                <li><strong>–ù–∞–≤–∏–≥–∞—Ü–∏—è:</strong> –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Ä–∞–∑–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã</li>
            </ol>
        </div>
        
        <div class="test-section">
            <h2>üîç –°—Ç–∞—Ç—É—Å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏</h2>
            <div class="navigation-status" id="navigation-status">
                <span class="status-badge status-warning">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
            </div>
            
            <h3>–û–∂–∏–¥–∞–µ–º—ã–µ –ø—É–Ω–∫—Ç—ã –º–µ–Ω—é:</h3>
            <ul id="expected-menu-items">
                <li>üè† –ì–ª–∞–≤–Ω–∞—è</li>
                <li>üìã –ó–∞–¥–∞—á–∏</li>
                <li>üìÖ –í—Å—Ç—Ä–µ—á–∏</li>
                <li>üìÅ –ü—Ä–æ–µ–∫—Ç—ã</li>
                <li>üõí –ü–æ–∫—É–ø–∫–∏</li>
                <li>üìù –ó–∞–º–µ—Ç–∫–∏</li>
                <li>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</li>
            </ul>
        </div>
        
        <div class="test-section">
            <h2>üõ†Ô∏è –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
            <div id="debug-info">
                <p>–ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏...</p>
            </div>
        </div>
    </div>
    
    <script>
        // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
        function updateDeviceInfo() {
            const deviceInfo = document.getElementById('device-info');
            const width = window.innerWidth;
            const height = window.innerHeight;
            const userAgent = navigator.userAgent;
            const isMobile = width <= 768;
            
            deviceInfo.innerHTML = `
                –®–∏—Ä–∏–Ω–∞ —ç–∫—Ä–∞–Ω–∞: ${width}px<br>
                –í—ã—Å–æ—Ç–∞ —ç–∫—Ä–∞–Ω–∞: ${height}px<br>
                –ú–æ–±–∏–ª—å–Ω—ã–π —Ä–µ–∂–∏–º: ${isMobile ? '–î–ê' : '–ù–ï–¢'}<br>
                User Agent: ${userAgent}
            `;
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        function checkNavigationStatus() {
            const statusContainer = document.getElementById('navigation-status');
            const debugContainer = document.getElementById('debug-info');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            const navbar = document.querySelector('.api-navbar');
            const sidebar = document.querySelector('.api-sidebar');
            const mobileMenu = document.getElementById('mobile-menu-dropdown');
            
            let statuses = [];
            let debugInfo = [];
            
            if (navbar) {
                statuses.push('<span class="status-badge status-success">Navbar ‚úì</span>');
                debugInfo.push('‚úÖ Navbar –Ω–∞–π–¥–µ–Ω');
            } else {
                statuses.push('<span class="status-badge status-error">Navbar ‚úó</span>');
                debugInfo.push('‚ùå Navbar –Ω–µ –Ω–∞–π–¥–µ–Ω');
            }
            
            if (sidebar) {
                statuses.push('<span class="status-badge status-success">Sidebar ‚úì</span>');
                debugInfo.push('‚úÖ Sidebar –Ω–∞–π–¥–µ–Ω');
            } else {
                statuses.push('<span class="status-badge status-error">Sidebar ‚úó</span>');
                debugInfo.push('‚ùå Sidebar –Ω–µ –Ω–∞–π–¥–µ–Ω');
            }
            
            if (mobileMenu) {
                statuses.push('<span class="status-badge status-success">Mobile Menu ‚úì</span>');
                debugInfo.push('‚úÖ –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é –Ω–∞–π–¥–µ–Ω–æ');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—É–Ω–∫—Ç—ã –º–µ–Ω—é
                const menuItems = mobileMenu.querySelectorAll('.navbar-dropdown-item');
                debugInfo.push(`üì± –ü—É–Ω–∫—Ç–æ–≤ –≤ –º–æ–±–∏–ª—å–Ω–æ–º –º–µ–Ω—é: ${menuItems.length}`);
                
                menuItems.forEach((item, index) => {
                    const icon = item.querySelector('.navbar-dropdown-item-icon')?.textContent || '';
                    const text = item.textContent.replace(icon, '').trim();
                    debugInfo.push(`   ${index + 1}. ${icon} ${text}`);
                });
            } else {
                statuses.push('<span class="status-badge status-error">Mobile Menu ‚úó</span>');
                debugInfo.push('‚ùå –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º API –¥–∞–Ω–Ω—ã–µ
            fetch('/api/navigation?category=main')
                .then(response => response.json())
                .then(data => {
                    statuses.push('<span class="status-badge status-success">API ‚úì</span>');
                    debugInfo.push(`üîó API –≤–µ—Ä–Ω—É–ª ${data.navigation.length} –ø—É–Ω–∫—Ç–æ–≤`);
                    
                    data.navigation.forEach((item, index) => {
                        debugInfo.push(`   ${index + 1}. ${item.icon} ${item.title} (${item.url})`);
                    });
                    
                    updateDisplay();
                })
                .catch(error => {
                    statuses.push('<span class="status-badge status-error">API ‚úó</span>');
                    debugInfo.push(`‚ùå –û—à–∏–±–∫–∞ API: ${error.message}`);
                    updateDisplay();
                });
            
            function updateDisplay() {
                statusContainer.innerHTML = statuses.join('');
                debugContainer.innerHTML = '<pre>' + debugInfo.join('\n') + '</pre>';
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
        window.addEventListener('resize', updateDeviceInfo);
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
        document.addEventListener('apiNavigationLoaded', function(event) {
            console.log('üéâ API –Ω–∞–≤–∏–≥–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–∞:', event.detail);
            setTimeout(checkNavigationStatus, 500);
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        updateDeviceInfo();
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã –µ—Å–ª–∏ —Å–æ–±—ã—Ç–∏–µ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ
        setTimeout(() => {
            if (!document.querySelector('.api-navbar')) {
                checkNavigationStatus();
            }
        }, 2000);
    </script>
</body>
</html>