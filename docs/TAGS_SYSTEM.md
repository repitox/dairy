# –°–∏—Å—Ç–µ–º–∞ —Ç–µ–≥–æ–≤ –¥–ª—è –∑–∞–¥–∞—á, –≤—Å—Ç—Ä–µ—á –∏ –ø–æ–∫—É–ø–æ–∫

## –û–ø–∏—Å–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ —Ç–µ–≥–æ–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏ –±—ã—Å—Ç—Ä–æ –Ω–∞—Ö–æ–¥–∏—Ç—å –∑–∞–¥–∞—á–∏, –≤—Å—Ç—Ä–µ—á–∏ –∏ –ø–æ–∫—É–ø–∫–∏ –≤ —Ä–∞–º–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤. –ö–∞–∂–¥—ã–π —Ç–µ–≥ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è –∏ —Ü–≤–µ—Ç–∞ —Ñ–æ–Ω–∞ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. **–ì–∏–±–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è**: –¢–µ–≥–∏ –º–æ–≥—É—Ç —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–ª–æ–≤, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç —ç–º–æ–¥–∑–∏, –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ 1 —Å–∏–º–≤–æ–ª
2. **–ü—Ä–∏–≤—è–∑–∫–∞ –∫ –ø—Ä–æ–µ–∫—Ç—É**: –¢–µ–≥–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º –ø—Ä–æ–µ–∫—Ç–∞
3. **–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å**: –í –æ–¥–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–≤—É—Ö —Ç–µ–≥–æ–≤ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏
4. **–°—Ç–∏–ª—å**: –ö–∞–∂–¥—ã–π —Ç–µ–≥ –∏–º–µ–µ—Ç —Ñ–æ–Ω (hex color) –¥–ª—è –æ—Ç–ª–∏—á–∏—è

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

#### –¢–∞–±–ª–∏—Ü–∞ `tags`
```sql
CREATE TABLE tags (
    id SERIAL PRIMARY KEY,
    name TEXT NOT NULL,
    background_color TEXT NOT NULL DEFAULT '#6366f1',
    project_id INTEGER NOT NULL REFERENCES projects(id) ON DELETE CASCADE,
    created_by_id INTEGER NOT NULL REFERENCES users(id),
    created_at TEXT,
    active BOOLEAN DEFAULT TRUE,
    UNIQUE (project_id, name)
);
```

#### –¢–∞–±–ª–∏—Ü–∞ `tag_associations`
–°–≤—è–∑—ã–≤–∞–µ—Ç —Ç–µ–≥–∏ —Å –æ–±—ä–µ–∫—Ç–∞–º–∏ (–∑–∞–¥–∞—á–∏, –≤—Å—Ç—Ä–µ—á–∏, –ø–æ–∫—É–ø–∫–∏):

```sql
CREATE TABLE tag_associations (
    id SERIAL PRIMARY KEY,
    tag_id INTEGER NOT NULL REFERENCES tags(id) ON DELETE CASCADE,
    object_type TEXT NOT NULL CHECK (object_type IN ('task', 'event', 'purchase')),
    object_id INTEGER NOT NULL,
    created_at TEXT,
    UNIQUE (tag_id, object_type, object_id)
);
```

### –ú–æ–¥–µ–ª–∏

#### `Tag` (app/database/models/tag.py)
```python
@dataclass
class Tag:
    id: Optional[int] = None
    name: str = ""
    background_color: str = "#6366f1"
    project_id: int = None
    created_by_id: int = None
    created_at: Optional[str] = None
    active: bool = True
```

#### `TagAssociation` (app/database/models/tag.py)
```python
@dataclass
class TagAssociation:
    id: Optional[int] = None
    tag_id: int = None
    object_type: str = ""  # 'task', 'event', 'purchase'
    object_id: int = None
    created_at: Optional[str] = None
```

### –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

#### `TagRepository` (app/database/repositories/tag_repository.py)
- `create_tag(tag: Tag) -> Tag` - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç–µ–≥
- `get_tag(tag_id: int) -> Tag` - –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–≥ –ø–æ ID
- `get_project_tags(project_id: int, active_only: bool) -> list` - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç–µ–≥–∏ –ø—Ä–æ–µ–∫—Ç–∞
- `update_tag(tag: Tag) -> bool` - –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ–≥
- `delete_tag(tag_id: int) -> bool` - –£–¥–∞–ª–∏—Ç—å —Ç–µ–≥
- `check_tag_exists(project_id: int, name: str, exclude_id: int) -> bool` - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è

#### `TagAssociationRepository` (app/database/repositories/tag_repository.py)
- `add_tag_to_object(tag_id, object_type, object_id) -> TagAssociation` - –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–≥ –∫ –æ–±—ä–µ–∫—Ç—É
- `remove_tag_from_object(tag_id, object_type, object_id) -> bool` - –£–¥–∞–ª–∏—Ç—å —Ç–µ–≥ –æ—Ç –æ–±—ä–µ–∫—Ç–∞
- `get_object_tags(object_type, object_id) -> list` - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç–µ–≥–∏ –æ–±—ä–µ–∫—Ç–∞
- `get_objects_by_tag(tag_id) -> list` - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã —Å –¥–∞–Ω–Ω—ã–º —Ç–µ–≥–æ–º
- `clear_object_tags(object_type, object_id) -> bool` - –£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Ç–µ–≥–∏ –æ—Ç –æ–±—ä–µ–∫—Ç–∞

### API Endpoints

–í—Å–µ endpoints –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `/api/tags`:

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–≥–∞–º–∏
- `GET /api/tags/{project_id}` - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç–µ–≥–∏ –ø—Ä–æ–µ–∫—Ç–∞
- `POST /api/tags` - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç–µ–≥
- `GET /api/tag/{tag_id}` - –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–≥ –ø–æ ID
- `PUT /api/tag/{tag_id}` - –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ–≥
- `DELETE /api/tag/{tag_id}` - –£–¥–∞–ª–∏—Ç—å —Ç–µ–≥

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤—è–∑—è–º–∏
- `POST /api/tag/assign` - –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–≥ –∫ –æ–±—ä–µ–∫—Ç—É (task/event/purchase)
- `DELETE /api/tag/unassign/{tag_id}/{object_type}/{object_id}` - –£–¥–∞–ª–∏—Ç—å —Ç–µ–≥ –æ—Ç –æ–±—ä–µ–∫—Ç–∞
- `GET /api/object/tags/{object_type}/{object_id}` - –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–≥–∏ –æ–±—ä–µ–∫—Ç–∞
- `GET /api/tag/{tag_id}/objects/{object_type}` - –ü–æ–ª—É—á–∏—Ç—å –æ–±—ä–µ–∫—Ç—ã —Å —Ç–µ–≥–æ–º

### –§—Ä–æ–Ω—Ç–µ–Ω–¥

#### UI –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (dashboard/ui-components.css)
- `.tag` - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤–∏–¥ —Ç–µ–≥–∞
- `.tag-container` - –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Ç–µ–≥–∞ —Å –∫–Ω–æ–ø–∫–æ–π —É–¥–∞–ª–µ–Ω–∏—è
- `.tag-remove` - –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ç–µ–≥–∞ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Ö–æ–≤–µ—Ä–µ)
- `.tags-container` - –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≥—Ä—É–ø–ø—ã —Ç–µ–≥–æ–≤
- `.tags-input-wrapper` - –û–±–µ—Ä—Ç–∫–∞ –¥–ª—è –ø–æ–ª—è –≤–≤–æ–¥–∞ —Ç–µ–≥–æ–≤
- `.tags-input` - –ü–æ–ª–µ –≤–≤–æ–¥–∞ –¥–ª—è –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–µ–≥–∞
- `.tags-add-btn` - –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–µ–≥–∞

#### –°—Ç—Ä–∞–Ω–∏—Ü—ã
- **project-tags.html** - –°—Ç—Ä–∞–Ω–∏—Ü–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–≥–∞–º–∏ –ø—Ä–æ–µ–∫—Ç–∞
  - –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ–≥–æ–≤ —Å –≤—ã–±–æ—Ä–æ–º —Ü–≤–µ—Ç–∞
  - –ü—Ä–æ—Å–º–æ—Ç—Ä –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–µ–≥–æ–≤
  - –£–¥–∞–ª–µ–Ω–∏–µ —Ç–µ–≥–æ–≤
  - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Ç–µ–≥–æ–≤

#### UI Kit
- `dashboard/ui-kit.html` - –ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Ç–µ–≥–æ–≤ –≤ —Ä–∞–∑–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–≥–∞

```javascript
const response = await fetch('/api/tags', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
        name: 'üöÄ –°—Ä–æ—á–Ω–æ',
        background_color: '#ec4899',
        project_id: 1
    })
});
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–≥–∞ –∫ –∑–∞–¥–∞—á–µ

```javascript
const response = await fetch('/api/tag/assign', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
        tag_id: 5,
        object_type: 'task',
        object_id: 42
    })
});
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–≥–æ–≤ –æ–±—ä–µ–∫—Ç–∞

```javascript
const response = await fetch('/api/object/tags/task/42');
const data = await response.json();
console.log(data.tags); // –ú–∞—Å—Å–∏–≤ —Ç–µ–≥–æ–≤
```

## –°—Ç–∏–ª–∏ —Ç–µ–≥–æ–≤

–ö–∞–∂–¥—ã–π —Ç–µ–≥ –∏–º–µ–µ—Ç —Å–≤–æ–π —Ü–≤–µ—Ç —Ñ–æ–Ω–∞ (hex —Ñ–æ—Ä–º–∞—Ç):

- `#6366f1` - –ò–Ω–¥–∏–≥–æ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `#ec4899` - –†–æ–∑–æ–≤—ã–π
- `#f59e0b` - –Ø–Ω—Ç–∞—Ä–Ω—ã–π
- `#10b981` - –ó–µ–ª–µ–Ω—ã–π
- `#8b5cf6` - –§–∏–æ–ª–µ—Ç–æ–≤—ã–π
- `#06b6d4` - –ì–æ–ª—É–±–æ–π
- `#ff6b6b` - –ö—Ä–∞—Å–Ω—ã–π
- `#fbbf24` - –ó–æ–ª–æ—Ç–æ–π

## –í–∞–ª–∏–¥–∞—Ü–∏—è

- **–ù–∞–∑–≤–∞–Ω–∏–µ**: –º–∏–Ω–∏–º—É–º 1 —Å–∏–º–≤–æ–ª, –º–∞–∫—Å–∏–º—É–º 50 —Å–∏–º–≤–æ–ª–æ–≤
- **–¶–≤–µ—Ç**: –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π hex –∫–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, #6366f1)
- **–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å**: –≤ –æ–¥–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–≤—É—Ö —Ç–µ–≥–æ–≤ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º (–±–µ–∑ —É—á–µ—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞)

## –ú–∏–≥—Ä–∞—Ü–∏–∏

–°–∏—Å—Ç–µ–º–∞ —Ç–µ–≥–æ–≤ –±—ã–ª–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å–ª–µ–¥—É—é—â–∏–º–∏ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏:

- `20250303_120000_create_tags_table.py` - –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã tags
- `20250303_120001_create_tag_associations_table.py` - –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã tag_associations

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. –¢–µ–≥–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç —ç–º–æ–¥–∑–∏ –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö –¥–ª—è –±–æ–ª—å—à–µ–π –≥–∏–±–∫–æ—Å—Ç–∏
2. –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ç–µ–≥–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è –≤—Å–µ —Å–≤—è–∑–∏ —ç—Ç–æ–≥–æ —Ç–µ–≥–∞ —Å –æ–±—ä–µ–∫—Ç–∞–º–∏ (–±–ª–∞–≥–æ–¥–∞—Ä—è ON DELETE CASCADE)
3. –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–∞ (–∑–∞–¥–∞—á–∏, –≤—Å—Ç—Ä–µ—á–∏, –ø–æ–∫—É–ø–∫–∏) –µ–≥–æ —Ç–µ–≥–∏ –æ—Å—Ç–∞—é—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ (–∏—Ö –Ω—É–∂–Ω–æ —É–¥–∞–ª—è—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ, –µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
4. –í—Å–µ —Ç–µ–≥–∏ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –ø—Ä–æ–µ–∫—Ç–∞–º –∏ –≤–∏–¥–Ω—ã —Ç–æ–ª—å–∫–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
5. –¶–≤–µ—Ç —Ç–µ–≥–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Ü–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ (–±–µ–ª—ã–π –∏–ª–∏ —á–µ—Ä–Ω—ã–π) –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —è—Ä–∫–æ—Å—Ç–∏ —Ñ–æ–Ω–∞
