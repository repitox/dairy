# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–∫—É–ø–æ–∫ –≤ WebApp

## –ü—Ä–æ–±–ª–µ–º–∞

–í WebApp –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/static/index.html` –≤ —Å–ø–∏—Å–∫–µ –ø–æ–∫—É–ø–æ–∫ –≤–º–µ—Å—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–ª—Å—è `undefined`.

## –ü—Ä–∏—á–∏–Ω–∞

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ–∫—É–ø–æ–∫ (v3.0.3) –≤—Å–µ API endpoints —Å—Ç–∞–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `purchases` —Å –ø–æ–ª–µ–º `name`, –Ω–æ WebApp –ø—Ä–æ–¥–æ–ª–∂–∞–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä–æ–µ –ø–æ–ª–µ `item`.

### –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–æ–ª–µ–π:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–ª–µ | –§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª–µ –≤ API | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|-----------|----------------|------------------------|-----------|
| WebApp index.html | `item.item` | `item.name` | `undefined` ‚ùå |
| WebApp shopping.html | `item.item` | `item.name` | `undefined` ‚ùå |
| Dashboard | `item.name` | `item.name` | –†–∞–±–æ—Ç–∞–µ—Ç ‚úÖ |

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### 1. `/static/index.html` ‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞**: –í —Ñ—É–Ω–∫—Ü–∏–∏ `renderShopping()` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å –ø–æ–ª–µ `item.item`

**–ë—ã–ª–æ:**
```javascript
shopping.forEach(item => {
    const text = item.quantity ? `${item.quantity} x ${item.item}` : item.item;
    // ...
});
```

**–°—Ç–∞–ª–æ:**
```javascript
shopping.forEach(item => {
    const text = item.quantity ? `${item.quantity} x ${item.name}` : item.name;
    // ...
});
```

### 2. `/static/shopping.html` ‚úÖ

#### 2.1 –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞

**–ë—ã–ª–æ:**
```javascript
<strong>${item.item}</strong> √ó ${item.quantity}
```

**–°—Ç–∞–ª–æ:**
```javascript
<strong>${item.name}</strong> √ó ${item.quantity}
```

#### 2.2 –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞

**–ü—Ä–æ–±–ª–µ–º–∞**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å –ø–æ–ª–µ `item.status` (string), –Ω–æ API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `item.completed` (boolean)

**–ë—ã–ª–æ:**
```javascript
<span>–°—Ç–∞—Ç—É—Å: ${item.status}</span>
// ...
${item.status === '–ù—É–∂–Ω–æ –∫—É–ø–∏—Ç—å' ? `
```

**–°—Ç–∞–ª–æ:**
```javascript
<span>–°—Ç–∞—Ç—É—Å: ${item.completed ? '–ö—É–ø–ª–µ–Ω–æ' : '–ù—É–∂–Ω–æ –∫—É–ø–∏—Ç—å'}</span>
// ...
${!item.completed ? `
```

#### 2.3 –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞

**–ü—Ä–æ–±–ª–µ–º–∞**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π API endpoint

**–ë—ã–ª–æ:**
```javascript
async function markStatus(id, status) {
    await fetch("/api/shopping/" + id, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ status })
    });
}
```

**–°—Ç–∞–ª–æ:**
```javascript
async function markStatus(id, status) {
    if (status === '–ö—É–ø–ª–µ–Ω–æ') {
        // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ–∫—É–ø–∫–∏
        await fetch(`/api/shopping/${id}/toggle`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ user_id: tg.initDataUnsafe.user?.id })
        });
    } else if (status === '–£–¥–∞–ª–µ–Ω–æ') {
        // –£–¥–∞–ª—è–µ–º –ø–æ–∫—É–ø–∫—É
        await fetch(`/api/shopping/${id}`, {
            method: "DELETE"
        });
    }
}
```

#### 2.4 –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ñ–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–∫—É–ø–∫–∏

**–ü—Ä–æ–±–ª–µ–º–∞**: –û—Ç–ø—Ä–∞–≤–ª—è–ª–æ—Å—å –ø–æ–ª–µ `item` –≤–º–µ—Å—Ç–æ `name`

**–ë—ã–ª–æ:**
```javascript
const item = document.getElementById("item").value;
// ...
body: JSON.stringify({ item, quantity, user_id: tg.initDataUnsafe.user?.id, project_id: projectId })
```

**–°—Ç–∞–ª–æ:**
```javascript
const name = document.getElementById("item").value;
// ...
body: JSON.stringify({ name, quantity, user_id: tg.initDataUnsafe.user?.id, category: "other" })
```

## –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ API endpoints

### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ endpoints (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è):

| –î–µ–π—Å—Ç–≤–∏–µ | Method | Endpoint | –ü–æ–ª—è |
|----------|--------|----------|------|
| –ü–æ–ª—É—á–∏—Ç—å –ø–æ–∫—É–ø–∫–∏ | GET | `/api/shopping?user_id={id}` | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `name`, `completed` |
| –î–æ–±–∞–≤–∏—Ç—å –ø–æ–∫—É–ø–∫—É | POST | `/api/shopping` | –ü—Ä–∏–Ω–∏–º–∞–µ—Ç `name`, `quantity`, `category` |
| –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å | POST | `/api/shopping/{id}/toggle` | –ü—Ä–∏–Ω–∏–º–∞–µ—Ç `user_id` |
| –£–¥–∞–ª–∏—Ç—å –ø–æ–∫—É–ø–∫—É | DELETE | `/api/shopping/{id}` | - |

### ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ endpoints (–¥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è):

| –î–µ–π—Å—Ç–≤–∏–µ | Method | Endpoint | –ü—Ä–æ–±–ª–µ–º–∞ |
|----------|--------|----------|----------|
| –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å | PUT | `/api/shopping/{id}` | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ –∏ –ø–æ–ª—è |
| –î–æ–±–∞–≤–∏—Ç—å –ø–æ–∫—É–ø–∫—É | POST | `/api/shopping` | –ü–æ–ª–µ `item` –≤–º–µ—Å—Ç–æ `name` |

## –†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
üõí –ü–æ–∫—É–ø–∫–∏ –≤ WebApp:
‚ñ™Ô∏è 1 √ó undefined
‚ñ™Ô∏è 1 √ó undefined  
‚ñ™Ô∏è 1 √ó undefined

–°—Ç–∞—Ç—É—Å: undefined
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
üõí –ü–æ–∫—É–ø–∫–∏ –≤ WebApp:
‚ñ™Ô∏è 1 √ó –ú–æ–ª–æ–∫–æ 3.2%
‚ñ™Ô∏è 1 √ó –•–ª–µ–±
‚ñ™Ô∏è 1 √ó –ú—è—Å–æ

–°—Ç–∞—Ç—É—Å: –ù—É–∂–Ω–æ –∫—É–ø–∏—Ç—å
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö API

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ë–î
docker-compose exec app python -c "
from db import get_shopping_items
items = get_shopping_items(123456789)
for item in items:
    print(f'ID: {item[\"id\"]}, name: {item[\"name\"]}, quantity: {item[\"quantity\"]}, completed: {item[\"completed\"]}')
"

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# ID: 3, name: –ú—è—Å–æ, quantity: 1, completed: False
# ID: 2, name: –•–ª–µ–±, quantity: 1, completed: False  
# ID: 1, name: –ú–æ–ª–æ–∫–æ 3.2%, quantity: 1, completed: False
```

## –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

–¢–µ–ø–µ—Ä—å –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ø–æ–ª—è:

### ‚úÖ Dashboard (–±—Ä–∞—É–∑–µ—Ä)
- **main.html**: `item.name`, `item.completed` ‚úÖ
- **shopping.html**: `item.name`, `item.completed` ‚úÖ
- **projects.html**: `item.name`, `item.completed` ‚úÖ

### ‚úÖ WebApp (Telegram)
- **index.html**: `item.name`, `item.completed` ‚úÖ
- **shopping.html**: `item.name`, `item.completed` ‚úÖ

### ‚úÖ Scheduler (—Ä–∞—Å—Å—ã–ª–∫–∞)
- **scheduler.py**: `item.name`, `item.completed` ‚úÖ

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –£–¥–∞–ª–µ–Ω—ã –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
–í WebApp —É–±—Ä–∞–Ω—ã –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã API:
- `project_id` - –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ç–µ–∫—É—â–∏–º API
- `status` - –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ `completed`

### 2. –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –ø–æ–∫—É–ø–∫–∏ –≤ WebApp —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è `category: "other"` –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏.

### 3. –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
–§—É–Ω–∫—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ HTTP –º–µ—Ç–æ–¥—ã –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –æ—Ç–≤–µ—Ç—ã API.

## –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏—è | –°—Ç—Ä–æ–∫ |
|------|-----------|-------|
| `static/index.html` | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `item.item` ‚Üí `item.name` | 1 |
| `static/shopping.html` | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è, API endpoints, —Å—Ç–∞—Ç—É—Å—ã | 8 |

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
- API endpoints –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å
- Dashboard –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### ‚úÖ –ë—É–¥—É—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –ø–æ–ª—è –≤ API
- –ü—Ä–æ—Å—Ç–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ WebApp
- –ï–¥–∏–Ω–∞—è —Å—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

---

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**: 2025-01-27  
**–í–µ—Ä—Å–∏—è**: v3.0.5  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ